## 7.4 å‹ã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®è©³ç´°éƒ¨åˆ†ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹

ã‚¹ãƒ†ãƒ¼ãƒˆãƒã‚·ãƒ³ã®çŠ¶æ…‹é·ç§»ã‚’æ§‹æˆã™ã‚‹ï¼‘ã‚¹ãƒ†ãƒƒãƒ—ã‚’ã€
å…¥åŠ›ã¨å‡ºåŠ›ã‚’æŒã¤é–¢æ•°ã¨ã—ã¦ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã¦å®Ÿè£…

å„ãƒ—ãƒ­ã‚»ã‚¹ã«æ»²ã‚“ã§ã„ã‚‹ä¾å­˜  
â†’åŒã˜ãã€é–¢æ•°ã¨ã—ã¦ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã¦å®Ÿè£…ã™ã‚‹

### 7.4.1 æœªæ¤œè¨¼â†’æ¤œè¨¼æ¸ˆã®çŠ¶æ…‹é·ç§»ã‚’è¡Œã†ã‚µãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã‚’é–¢æ•°ã«ã™ã‚‹

1. å…¥å‡ºåŠ›ã‚’æ–‡ç« åŒ–

   ä¾‹ï¼‰ã€Œæ³¨æ–‡ã®æ¤œè¨¼ã€ã‚¹ãƒ†ãƒƒãƒ—

   å…¥åŠ›ï¼š`UnvalidatedOrder`

   å‡ºåŠ›ï¼š`ValidatedOrder`/`ValidationError`


2. ä¾å­˜é–¢ä¿‚ã‚‚æ–‡ç« åŒ–

   é–¢æ•°åŒ–ã—ãŸã„ã‚¹ãƒ†ãƒƒãƒ—ã«ä¾å­˜é–¢ä¿‚ãŒå«ã¾ã‚Œã‚‹å ´åˆã€ã“ã¡ã‚‰ã‚‚åŒæ§˜ã«é–¢æ•°ã¨ã—ã¦æ‰±ãˆã‚‹ã‚ˆã†ãƒ¢ãƒ‡ãƒ«åŒ–ã™ã‚‹ï¼ˆä½•ã®å…¥å‡ºåŠ›ãŒè¡Œã‚ã‚Œã‚‹ã‹ã€ã‚·ã‚°ãƒãƒãƒ£ã‚’å®šç¾©ã—ã¦ãŠãï¼‰

   ä¾‹ï¼‰ã€Œæ³¨æ–‡ã®æ¤œè¨¼ã€ã‚¹ãƒ†ãƒƒãƒ—ãŒä¾å­˜ã—ã¦ã„ã‚‹ã‚µãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã€Œè£½å“ã‚³ãƒ¼ãƒ‰ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã€ã®ãƒ¢ãƒ‡ãƒ«åŒ–  
   å…¥åŠ›ï¼š`ProductCode`  
   å‡ºåŠ›ï¼š`bool`  
   ï¼ˆé–¢æ•°å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯é–¢æ•°ã‚‚å‹ãªã®ã§ã€ï¼‰ è£½å“ã‚³ãƒ¼ãƒ‰ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã‚’ã™ã‚‹å‹ãŒã“ã‚Œã§å®Œæˆ


###  ä¾å­˜é–¢ä¿‚ã®ãƒ¢ãƒ‡ãƒ«åŒ–ã‚’è¡Œã†ã¨ãã®è¦ç‚¹ï¼“ã¤ï¼š
- **7.4.1 è¦ç‚¹ï¼‘ï¼šä¾å­˜é–¢ä¿‚ã‹ã‚‰ã®å‡ºåŠ›ã¯ã€æ³¨ç›®ä¸­ã®ã‚¹ãƒ†ãƒƒãƒ—å†…ã§è§¦ã‚‰ãªã„**  
  ã¨ã„ã†ã‹ã€ãã‚Œã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®é–¢æ•°ã«è¾¿ã‚Šç€ãã¾ã§ã€ãã®å‹ã®ã¾ã¾è¿”ã—ç¶šã‘ã‚‹ã€‚  
  ä¾‹ï¼‰ä¾å­˜ã€Œã‚¢ãƒ‰ãƒ¬ã‚¹ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã€ã‚’å«ã‚€ã€Œæ³¨æ–‡ã®æ¤œè¨¼ã€ã‚¹ãƒ†ãƒƒãƒ—ã®å ´åˆ
    - å‡ºåŠ›ï¼šResultå‹
    - å‡ºåŠ›ã®ä¸­èº«ï¼‘ï¼šæˆåŠŸã®å‹`CheckedAddress`
    - å‡ºåŠ›ã®ä¸­èº«ï¼’ï¼šå¤±æ•—ã®å‹`AddressValidateionError`

      ã€Œã‚¢ãƒ‰ãƒ¬ã‚¹ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯å¤±æ•—ã€ç”¨ã®ã‚¨ãƒ©ãƒ¼ç”»é¢ã¸é·ç§»ã•ã›ã‚‹é–¢æ•°ãªã©ã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«ãŸã©ã‚Šç€ãå‰ã«ä¸Šè¨˜ã®å‹ã‚’ä½¿ã£ãŸä½•ã‚‰ã‹ã®å‡¦ç†ã‚’è¡Œã†ï¼æ±šæŸ“ãŒèµ·ã“ã‚‹
      â€»ã‚¢ãƒ‰ãƒ¬ã‚¹æ¤œè¨¼ã®å¤±æ•—ã«ã¤ã„ã¦ã€ã©ã‚“ãªé¢¨ã«è¿”ã™ãƒ»ã©ã‚“ãªé¢¨ã«æ‰±ã†ã¨ã„ã£ãŸæƒ…å ±ã¯ã€æ³¨ç›®ä¸­ã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã¯é–¢ä¿‚ã®ãªã„ã€Œè©³ç´°ã€ã«ã‚ãŸã‚‹ãŸã‚ã€‚

      ãªã®ã§ã€ã€Œæ³¨æ–‡ã®æ¤œè¨¼ã€ã‚¹ãƒ†ãƒƒãƒ—`ValidationOrder`ã®å‡ºåŠ›ã«ã¯ã€Œãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå¿…è¦ãªResultå‹ã‚’å«ã¿ã¾ã™ï¼ã€ã¨ã ã‘å‹ã§è¡¨ç¾ã™ã‚‹ã‚ˆã†ã«è¿”ã™ã€‚æ¬¡ã®é–¢æ•°ã§ã‚‚ã€ãã‚Œã‚’å¼•ãç¶™ãç¶šã‘ã‚‹ã€‚

- **7.4.2 è¦ç‚¹ï¼’ï¼šä¾å­˜é–¢ä¿‚ã‹ã‚‰è©³ç´°ã‚’æŒã£ã¦ã“ãªã„ã‚ˆã†ã«ã™ã‚‹**

  ãã‚‚ãã‚‚ä¾å­˜é–¢ä¿‚ã®å‹ã‚„ãã®ä¸­ã®å‡¦ç†ãªã©ã®è©³ç´°ã¯ã€å¾Œã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã—ã¦å®Ÿè£…ã™ã‚‹äºˆå®šã ãŒã€ãã®å®Ÿè£…è€…ã—ã‹çŸ¥ã‚‰ãªãã¦è‰¯ã„ã‚ˆã†ãªè©³ç´°ã¯ã€ä¾å­˜å…ˆã®ä¸­ã ã‘ã§ç•™ã‚ã‚‹ã€‚
  æ³¨ç›®ã—ã¦ã„ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€Œè©³ç´°ã‚’ä¾å­˜å…ˆã‹ã‚‰æŒã£ã¦ãã‚‹é–¢æ•°ã€ã‚’ä½œã£ã¦ãã®ã‚·ã‚°ãƒãƒãƒ£ã ã‘å—ã‘å–ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

  ä¾‹ï¼‰ã€Œæ³¨æ–‡ã®ä¾¡æ ¼è¨ˆç®—ã€ã‚¹ãƒ†ãƒƒãƒ—ãŒä¾å­˜ã—ã¦ã„ã‚‹ã‚µãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã€Œè£½å“ã‚«ã‚¿ãƒ­ã‚°ã‹ã‚‰ã®æƒ…å ±å–å¾—ã€ã®ãƒ¢ãƒ‡ãƒ«åŒ–

  âŒtype IProductCatalog  
  â­•ï¸type GetProductPrice

  ä¾å­˜é–¢ä¿‚ã®ãƒ¢ãƒ‡ãƒ«ã€Œè£½å“ã‚«ã‚¿ãƒ­ã‚°ã‹ã‚‰ã®æƒ…å ±å–å¾—ã€ã‹ã‚‰å—ã‘å–ã‚‹å‹ã‚·ã‚°ãƒãƒãƒ£ã¯ã€æ³¨ç›®ã—ã¦ã„ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã€Œæ³¨æ–‡ã®ä¾¡æ ¼è¨ˆç®—ã€ã§å¿…è¦ãªã€Œè£½å“ã®ä¾¡æ ¼æƒ…å ±ã€ã ã‘ã‚’æä¾›ã™ã‚‹é–¢æ•°ã«ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä¾å­˜å…ˆã®ä¸­ã ã‘ã§å®Œçµã—ã¦ã»ã—ã„å•†å“ã‚«ã‚¿ãƒ­ã‚°ã¨ã„ã†è©³ç´°ã‚’éš ã™(ã‚«ãƒ—ã‚»ãƒ«åŒ–ï¼Ÿ)

- **7.4.3 è¦ç‚¹ï¼“ï¼šä¸€æ—¦ã€å…·ä½“çš„ãªå®Ÿè£…ã‚ˆã‚Šå…¥å‡ºåŠ›ã®å‹å®šç¾©ãŒå„ªå…ˆ**  
  ç†ç”±ã¨ã—ã¦ã¯ã€å¾Œã‹ã‚‰å®Ÿè£…ã®è©³ç´°ã‚’æ±ºã‚ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åŒæ§˜ã«ã€(ãã†ã„ã†é¢¨ã«åˆ‡ã‚Šé›¢ã—ã¦ã‚‹ã¯ãšã®)è©³ç´°ã¯ã„ã¤ã§ã‚‚å¤‰æ›´ã§ãã‚‹ã‹ã‚‰ã€‚

  ä¾‹ï¼‰ã€Œæ³¨æ–‡ã®ç¢ºèªã€ã‚¹ãƒ†ãƒƒãƒ—ãŒä¾å­˜ã—ã¦ã„ã‚‹ã‚µãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã€Œæ³¨æ–‡ç¢ºèªæ›¸ã®é€ä¿¡(SendOrderAcknowledgement)ã€ã«ã‚ˆã£ã¦è¿”ã‚‹ã‚‚ã®ã®ãƒ¢ãƒ‡ãƒ«åŒ–

  å—æ³¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å…¨ä½“ã§ã‚„ã‚ŠãŸã„ã“ã¨ï¼š  
  æ³¨æ–‡ç¢ºèªæ›¸ãŒé€ã‚‰ã‚ŒãŸã‚‰ã€ãã‚Œã‚’çŸ¥ã‚‰ã›ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã¸ã¤ãªã’ãŸã„

  ã€Œæ³¨æ–‡ç¢ºèªã€ã‚¹ãƒ†ãƒƒãƒ—ã§ã‚„ã‚ŠãŸã„ã“ã¨ï¼š  
  - æ³¨æ–‡ç¢ºèªã‚¤ãƒ™ãƒ³ãƒˆã®çµæœã‚’ã€æ¬¡ã®ã‚¤ãƒ™ãƒ³ãƒˆã«ç¹‹ã’ã‚„ã™ãé–¢æ•°ã§è¡¨ç¾ã—ã¦ãŠããŸã„  
  - æ³¨æ–‡ç¢ºèªã®å‰¯ä½œç”¨ã«ã¤ã„ã¦ã‚‚å‹ã‚·ã‚°ãƒãƒãƒ£ã§ã‚ã‹ã‚Šã‚„ã™ãè¡¨ç¾ã—ã¦ãŠããŸã„

> [!note]
> ã¤ã¾ã‚Šã€æœ¬ã‚¹ãƒ†ãƒƒãƒ—ã®å‡ºåŠ›ã«ã¤ã„ã¦æ±ºã‚ã‚‹ã¹ãã¯  
> ãƒ»ã€Œæ³¨æ–‡ã€ã‚’ã€€é€ã£ãŸ/é€ã‚Œã¦ãªã„ã€€ã®æƒ…å ±ã‚’ã©ã†æŒãŸã›ã‚‹ã‹  
> ãƒ»ã€Œé€ã£ãŸã€å ´åˆã«è¿”ã™ã‚¤ãƒ™ãƒ³ãƒˆã®å‹å®šç¾©

     â€»ãªãœã‚¤ãƒ™ãƒ³ãƒˆå‹ã§è¿”ã™ã‹ï¼š
     âŒunitã§è¿”ã™ï¼šå‰¯ä½œç”¨ãŒã‚ã‚‹ã“ã¨ã—ã‹åˆ†ã‹ã‚‰ãªã„
     ğŸ”ºboolã§è¿”ã™ï¼šä½•ã®çœŸå½ï¼Ÿã“ã‚Œã‚‚æƒ…å ±ãŒå°‘ãªã™ãã‚‹
     â­•ï¸ã‚¤ãƒ™ãƒ³ãƒˆå‹ã§è¿”ã™ï¼ˆã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚‚ã€å…¥å‡ºåŠ›ã‚’å®šç¾©ã—ã¦ãŠãï¼‰

- **7.4.4 è¦ç‚¹ï¼”ï¼šè¿”ã™ã‚¤ãƒ™ãƒ³ãƒˆãŒè¤‡æ•°ã«åˆ†å²ã™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„å ´åˆã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆå‹ã®ãƒªã‚¹ãƒˆã§è¿”ã™**

      ```go
      package main
    
      import "fmt"
    
      // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§å…±é€šå‹ã‚’å®šç¾©
      type PlaceOrderEvent interface {
          EventName() string
      }
    
      // ãã‚Œãã‚Œã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ§‹é€ ä½“ã¨ã—ã¦å®šç¾©
      type OrderPlaced struct{}
      type BillableOrderPlaced struct{}
      type OrderAcknowledgmentSent struct{}
    
      // EventName()ã§å‹è­˜åˆ¥ï¼Ÿ
      func (OrderPlaced) EventName() string               { return "OrderPlaced" }
      func (BillableOrderPlaced) EventName() string       { return "BillableOrderPlaced" }
      func (OrderAcknowledgmentSent) EventName() string   { return "AcknowledgmentSent" }
    
      func main() {
          // ã‚¤ãƒ™ãƒ³ãƒˆå‹ã®ãƒªã‚¹ãƒˆ
          events := []PlaceOrderEvent{
              OrderPlaced{},
              BillableOrderPlaced{},
              OrderAcknowledgmentSent{},
          }
        
          // æ³¨æ–‡ç¢ºèªã®çµæœã‚’PlaceOrderEventå‹ã§è¿”ã™
      }
      ```
